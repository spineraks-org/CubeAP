<!DOCTYPE html>
<html lang="en" >
<head>
  <meta charset="UTF-8">
  <title>Twisty Cube</title>
  <meta name="viewport" content="width=device-width,height=device-height,user-scalable=no,initial-scale=1.0,maximum-scale=1.0,minimum-scale=1.0"><link rel="stylesheet" href="./style.css">

</head>
<body>
<!-- partial:index.partial.html -->
<!-- PWA: https://bsehovac.github.io/the-cube/ -->









<!-- Login screen -->
<div class="login-container" id="login-container" style="font-size: 14px;">
  <h2 class="login-heading" style="font-size: 5em;">ðŸ§Š Twisty Cube ðŸ§Š</h2>
  <div style="width: 100%; font-family: Verdana, Geneva, sans-serif; font-size: 14px;"></div>
        <hr style="border: 5px solid #555599; margin: 8px 0; width: 100px;">
      <div style="margin-top: 5px; font-size: 0.9em; color: white; padding: 10px; text-align: center; border-radius: 10px;">
        <div style="color: #fff; font-size: 30px; font-weight: bold; margin-bottom: 8px;">Archipelago</div>
        <label for="hostport" class="login-label" style="font-size: 18px;">Host and Port</label>
        <input type="text" id="hostport" name="hostport" class="login-input" value="archipelago.gg:38281" placeholder="Example: archipelago.gg:38281" 
        style="font-family: Arial, Helvetica, sans-serif; text-transform: none;">
        <label for="name" class="login-label" style="font-size: 18px;">Player Name</label>
        <input type="text" id="name" name="name" class="login-input"
            value="Loading website...." placeholder="Example: Yachty"
            style="font-family: Arial, Helvetica, sans-serif; text-transform: none;">
        <label for="name" class="login-label" style="font-size: 18px;">Password</label>
        <input type="password" id="password" name="password" class="login-input" value="" placeholder="Leave blank if no password"
            style="font-family: Arial, Helvetica, sans-serif; text-transform: none;">
        <input type="submit" value="Login & Connect" id="loginbutton" class="login-submit" style="font-size: 20px;">
        <label id="error-label" class="login-label" style="color: red;"></label>
      </div>
      <!-- <hr style="border: 5px solid #555599; margin: 8px 0;"> -->

        <span style="display:inline-flex; align-items:center; gap:8px; white-space:nowrap; font-family: Arial, Helvetica, sans-serif; text-transform: none;">
          Archipelago Deathlink Setting: when someone deathlinks,
        </span>
        <span style="display:inline-flex; align-items:center; gap:8px; white-space:nowrap; font-family: Arial, Helvetica, sans-serif; text-transform: none;">
          randomly scramble
            <select id="deathlink-scramble" style="font-family: inherit; text-transform: none; margin: 0 4px;">
            <option value="0">0</option>
            <option value="1">1</option>
            <option value="2">2</option>
            <option value="5">5</option>
            <option value="10">10</option>
            <option value="100">100</option>
            </select>
            <script>
            (function(){
              const key = 'deathlink-scramble';
              const el = document.getElementById('deathlink-scramble');
              // Restore saved value (if any)
              const saved = localStorage.getItem(key);
              if (saved !== null) el.value = saved;
              // Persist changes
              el.addEventListener('change', () => localStorage.setItem(key, el.value));
            })();
            </script>
          times.
        </span>
        <span style="display:inline-flex; align-items:center; gap:8px; white-space:nowrap; font-family: Arial, Helvetica, sans-serif; text-transform: none;">
          <input type="checkbox" id="show-deathlinks" style="transform: scale(1.5);">
          <script>
            (function(){
              const key = 'show-deathlinks';
              const el = document.getElementById('show-deathlinks');
              // Initialize from localStorage
              el.checked = localStorage.getItem(key) === 'true';
              // Persist changes
              el.addEventListener('change', () => localStorage.setItem(key, el.checked ? 'true' : 'false'));
            })();
          </script>
          <label for="show-deathlinks" style="cursor: pointer; text-transform: none;" > Show cause of deathlink on-screen</label>
        </span>

      <hr style="border: 5px solid #555599; margin: 8px 0;">
      <div style="margin-top: 5px; font-size: 0.9em; color: white; padding: 10px; text-align: center; border-radius: 10px;">
        <div style="color: #fff; font-size: 30px; font-weight: bold; margin-bottom: 8px;">Try it out solo</div>
        <input type="checkbox" name="randomize_layout" value="randomize_layout">Â­
        <label for="randomize_layout">Randomize color layout</label>
        <div style="display: flex; gap: 10px;">
          <input type="submit" value="2 x 2 x 2" id="solobutton222" class="login-submit" style="font-size: 16px;text-transform: none;">
          <input type="submit" value="3 x 3 x 3" id="solobutton333" class="login-submit" style="font-size: 16px;text-transform: none;">
          <input type="submit" value="4 x 4 x 4" id="solobutton444" class="login-submit" style="font-size: 16px;text-transform: none;">
          <input type="submit" value="5 x 5 x 5" id="solobutton555" class="login-submit" style="font-size: 16px;text-transform: none;">
        </div>
      </div>
      <div style="margin-top: 5px; font-size: 0.9em; color: white; padding: 10px; text-align: center; border-radius: 10px;">
        Credits: original game by<br>
        <a href="https://codepen.io/bsehovac/pen/EMyWVv" target="_blank" rel="noopener noreferrer" style="color: #b3e5fc; text-decoration: underline;">codepen.io/bsehovac/pen/EMyWVv</a>
      </div>
</div>

<script>
  function getUrlParameter(name) {
      name = name.replace(/[\[]/, '\\[').replace(/[\]]/, '\\]');
      var regex = new RegExp('[\\?&]' + name + '=([^&#]*)');
      var results = regex.exec(location.search);
      return results === null ? '' : decodeURIComponent(results[1].replace(/\+/g, ' '));
  };

  document.getElementById('hostport').value = getUrlParameter('hostport') || localStorage.getItem("hostport") || "archipelago.gg:38281";
  document.getElementById('name').value = getUrlParameter('name') || localStorage.getItem("name") || 'Player1';
  document.getElementById('password').value = getUrlParameter('password') || '';

</script>






<!-- Simple pop-up modal -->
<style>
  .popup-overlay {
    position: fixed;
    inset: 0;
    background: rgba(0,0,0,0.6);
    display: none;
    align-items: center;
    justify-content: center;
    z-index: 9999;
  }
  .popup {
    background: #111;
    color: #fff;
    padding: 20px;
    max-width: 420px;
    width: calc(100% - 40px);
    border-radius: 10px;
    box-shadow: 0 10px 30px rgba(0,0,0,0.5);
    font-family: Arial, Helvetica, sans-serif;
    text-align: left;
    text-transform: none;
  }
  .popup h3 { margin: 0 0 8px 0; font-size: 1.25rem; text-transform: none;}
  .popup p { margin: 0 0 12px 0; font-size: 0.95rem; line-height: 1.35; text-transform: none;}
  .popup .actions { text-align: right; text-transform: none;}
  .popup .btn {
    background: #4a6bff;
    color: #fff;
    border: none;
    padding: 8px 12px;
    border-radius: 6px;
    cursor: pointer;
    font-size: 0.95rem;
    text-transform: none;
  }
  .popup .btn.secondary {
    background: transparent;
    color: #ddd;
    margin-right: 8px;
    border: 1px solid rgba(255,255,255,0.06);
  }
</style>




<div class="popup-overlay" id="simple-popup" role="dialog" aria-modal="true" aria-labelledby="popup-title">
  <div class="popup" role="document">
    <h3 id="popup-title">Welcome to Twisty Cube / Cube AP!</h3>
    <p>Try the solo modes or connect to an Archipelago server.</p>
    <p>You can control with mouse/touch or keyboard shortcuts (F/B/L/R/U/D (+SHIFT))</p>
    <p style="color: #ff0;">NEW! Press backspace or the arrow bottom-left to undo your last move. Thank you BaNyaaNyaa for adding this!</p>
    <p>More info and questions in the Archipelago discord server.</p>
  </div>
</div>

<script>
  (function(){
    const overlay = document.getElementById('simple-popup');
    const closeBtn = document.getElementById('popup-close');
    const gotItBtn = document.getElementById('popup-gotit');

    function showPopup() {
      if(localStorage.getItem('popup-shown') === 'true') return;
      overlay.style.display = 'flex';
      // focus for accessibility
    }
    function hidePopup() {
      overlay.style.display = 'none';
      // never show the popup again
      localStorage.setItem('popup-shown', 'true');
    }

    overlay.addEventListener('click', (e) => {
      if (e.target === overlay) hidePopup();
    });
    document.addEventListener('keydown', (e) => {
      if (e.key === 'Escape' && overlay.style.display === 'flex') hidePopup();
    });

    // Auto-show after a short delay on first load
    window.addEventListener('load', () => setTimeout(showPopup, 500));
  })();
</script>



<div id="loading-screen" style="display: none;">
  <h1>Connecting...</h1>
  <div class="loading-icon"><icon loading></icon></div>
</div>



<div class="ui" id = "ui" style="display: none;">

  <div class="ui__background"></div>

  <div class="ui__game"></div>

  <div class="ui__texts">
    <h1 class="text text--title">
      <span id="cube-prefix"></span>
      <script>
        const prefixes = [
            // "ARCHIPELA-",
            // "AP",
            // "SPINERAKS'",
            // "The",
            // "Mighty",
            // "Amazing",
            // "Rando",
            // "Mystic",
            "Twisty"
        ];
        document.getElementById("cube-prefix").textContent = prefixes[Math.floor(Math.random() * prefixes.length)];
      </script>
      <span id="cube-name"></span>
      <script>
        const names = [
            "Cube"
            // "Regular hexahedron",
            // "Cuboid",
            // "Voxel",
            // "Cubelet",
            // "Box",
            // "3D Square",
            // "Block",
            // "Puzzle"
        ];
        document.getElementById("cube-name").textContent = names[Math.floor(Math.random() * names.length)];
      </script>
    </h1>
    <div class="text text--note">
      Double tap to start<br> and reveal the stickers
    </div>
    <div class="text text--timer">
      0:00
    </div>
    <div class="text text--correctness">
    </div>
    <div class="text text--correctness2">
    </div>
    <div class="text text--complete">
      <span>Complete!</span>
    </div>
    <div class="text text--best-time">
      <icon trophy></icon>
      <span>Best Time!</span>
    </div>
  </div>

  <div class="ui__prefs">

    <!-- <range name="size" title="Cube Size" list="2,3,4,5"></range> -->
    <range name="flip" title="Flip Type" list="Swift&nbsp;,Smooth,Bounce"></range>
    <range name="scramble" title="Scramble Length" list="20,25,30"></range>
    <range name="fov" title="Camera Angle" list="Ortographic,Perspective"></range>
    <range name="theme" title="Color Scheme" list="Cube,Erno,Dust,Camo,Rain"></range>
    <br>
    <range name="credits_prefs" title="Credits: OG game by" list="codepen.io/bsehovac/pen/EMyWVv"></range>
  </div>

  <div class="ui__theme">
    <range name="hue" title="Hue" color></range>
    <range name="saturation" title="Saturation" color></range>
    <range name="lightness" title="Lightness" color></range>
  </div>

  <div class="ui__stats">
    <div class="stats" name="credits">
      <i>Credits:<br>OG game by:</i><b>codepen.io/<br>bsehovac/<br>pen/EMyWVv</b>
    </div>
    <div class="stats" name="cube-size">
      <i>Cube:</i><b>3x3x3</b>
    </div>
    <div class="stats" name="total-solves">
      <i>Total solves:</i><b>-</b>
    </div>
    <div class="stats" name="best-time">
      <i>Best time:</i><b>-</b>
    </div>
    <div class="stats" name="worst-time">
      <i>Worst time:</i><b>-</b>
    </div>
    <div class="stats" name="average-5">
      <i>Average of 5:</i><b>-</b>
    </div>
    <div class="stats" name="average-12">
      <i>Average of 12:</i><b>-</b>
    </div>
    <div class="stats" name="average-25">
      <i>Average of 25:</i><b>-</b>
    </div>
  </div>

  <div class="ui__buttons">
    <button class="btn btn--bl btn--stats">
      <icon trophy></icon>
    </button>
    <button class="btn btn--br btn--prefs">
      <icon settings></icon>
    </button>
    <button class="btn btn--bl btn--back">
      <icon back></icon>
    </button>
    <!-- <button class="btn btn--br btn--theme">
      <icon theme></icon>
    </button> -->
    <button class="btn btn--br btn--reset">
      <icon reset></icon>
    </button>
  </div>

</div>
<!-- partial -->
  <script src='https://cdnjs.cloudflare.com/ajax/libs/three.js/95/three.min.js'></script>
  <script src="./script.js"></script>
  <script type="module" src="./aplogin.js"></script>
  <script type="module" src="./soloplay.js"></script>

</body>
</html>
